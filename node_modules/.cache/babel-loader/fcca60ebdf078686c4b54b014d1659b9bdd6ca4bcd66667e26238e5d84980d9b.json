{"ast":null,"code":"import \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, vModelText as _vModelText, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, withModifiers as _withModifiers } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"page-product\"\n};\nvar _hoisted_2 = {\n  \"class\": \"catalog-card2\"\n};\nvar _hoisted_3 = {\n  \"class\": \"catalog-card2__imgbox\"\n};\nvar _hoisted_4 = {\n  \"class\": \"image mb-6\"\n};\nvar _hoisted_5 = [\"src\"];\nvar _hoisted_6 = {\n  \"class\": \"catalog-card2__description\"\n};\nvar _hoisted_7 = {\n  \"class\": \"catalog-card2__title\"\n};\nvar _hoisted_8 = /*#__PURE__*/_createElementVNode(\"div\", {\n  \"class\": \"catalog-card2__star\",\n  \"data-rateyo-rating\": \"4\"\n}, null, -1 /* HOISTED */);\nvar _hoisted_9 = {\n  \"class\": \"catalog-card2__price\"\n};\nvar _hoisted_10 = {\n  \"class\": \"catalog-card2__text\"\n};\nvar _hoisted_11 = {\n  \"class\": \"field has-addons mt-6\"\n};\nvar _hoisted_12 = {\n  \"class\": \"control\"\n};\nvar _hoisted_13 = {\n  \"class\": \"control\"\n};\nvar _hoisted_14 = {\n  \"class\": \"columns is multiline\"\n};\nvar _hoisted_15 = {\n  \"class\": \"column is-9\"\n};\nvar _hoisted_16 = /*#__PURE__*/_createElementVNode(\"h2\", {\n  \"class\": \"title\"\n}, \"Reviews:\", -1 /* HOISTED */);\nvar _hoisted_17 = /*#__PURE__*/_createElementVNode(\"p\", {\n  \"class\": \"title\"\n}, \"Review\", -1 /* HOISTED */);\nvar _hoisted_18 = {\n  \"class\": \"review-wrapper__text\"\n};\nvar _hoisted_19 = /*#__PURE__*/_createElementVNode(\"label\", {\n  \"for\": \"content\"\n}, \"Отзыв:\", -1 /* HOISTED */);\nvar _hoisted_20 = /*#__PURE__*/_createElementVNode(\"label\", {\n  \"for\": \"stars\"\n}, \"Оценка:\", -1 /* HOISTED */);\nvar _hoisted_21 = /*#__PURE__*/_createElementVNode(\"button\", {\n  type: \"submit\"\n}, \"Отправить отзыв\", -1 /* HOISTED */);\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"figure\", _hoisted_4, [_createElementVNode(\"img\", {\n    src: $data.product.get_image\n  }, null, 8 /* PROPS */, _hoisted_5)])]), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"h4\", _hoisted_7, _toDisplayString($data.product.name), 1 /* TEXT */), _hoisted_8, _createElementVNode(\"p\", _hoisted_9, \" $\" + _toDisplayString($data.product.price), 1 /* TEXT */), _createElementVNode(\"p\", _hoisted_10, _toDisplayString($data.product.description), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_11, [_createElementVNode(\"div\", _hoisted_12, [_withDirectives(_createElementVNode(\"input\", {\n    type: \"number\",\n    \"class\": \"input\",\n    min: \"1\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n      return $data.quantity = $event;\n    })\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.quantity]])]), _createElementVNode(\"div\", _hoisted_13, [_createElementVNode(\"a\", {\n    \"class\": \"button is-dark\",\n    onClick: _cache[1] || (_cache[1] = function () {\n      return $options.addToCart && $options.addToCart.apply($options, arguments);\n    })\n  }, \"Add to cart\")])])])]), _createElementVNode(\"div\", _hoisted_14, [_createElementVNode(\"div\", _hoisted_15, [_hoisted_16, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.reviews, function (review) {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: review.id,\n      \"class\": \"review-wrapper\"\n    }, [_hoisted_17, _createElementVNode(\"p\", null, \"User_name: \" + _toDisplayString(review.user), 1 /* TEXT */), _createElementVNode(\"p\", null, \"Stars: \" + _toDisplayString(review.stars), 1 /* TEXT */), _createElementVNode(\"p\", _hoisted_18, \"Review text:\" + _toDisplayString(review.content), 1 /* TEXT */), _createElementVNode(\"p\", null, \"Date: \" + _toDisplayString(review.date_added), 1 /* TEXT */)]);\n  }), 128 /* KEYED_FRAGMENT */)), _createElementVNode(\"div\", null, [_createElementVNode(\"form\", {\n    onSubmit: _cache[4] || (_cache[4] = _withModifiers(function () {\n      return $options.submitReview && $options.submitReview.apply($options, arguments);\n    }, [\"prevent\"]))\n  }, [_hoisted_19, _withDirectives(_createElementVNode(\"textarea\", {\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = function ($event) {\n      return $data.review.content = $event;\n    }),\n    id: \"content\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.review.content]]), _hoisted_20, _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = function ($event) {\n      return $data.review.stars = $event;\n    }),\n    type: \"number\",\n    id: \"stars\",\n    required: \"\",\n    max: \"5\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.review.stars, void 0, {\n    number: true\n  }]]), _hoisted_21], 32 /* HYDRATE_EVENTS */)])])])]);\n}","map":{"version":3,"names":["_createElementVNode","type","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","src","$data","product","get_image","_hoisted_6","_hoisted_7","_toDisplayString","name","_hoisted_8","_hoisted_9","price","_hoisted_10","description","_hoisted_11","_hoisted_12","min","quantity","$event","_hoisted_13","onClick","_cache","$options","addToCart","apply","arguments","_hoisted_14","_hoisted_15","_hoisted_16","_Fragment","_renderList","reviews","review","key","id","_hoisted_17","user","stars","_hoisted_18","content","date_added","onSubmit","_withModifiers","submitReview","_hoisted_19","required","_hoisted_20","max","_hoisted_21"],"sources":["/Users/belgee/Desktop/ICSI402-Software-Development/TeamProject/TSHOP-Frontend-VueJS/src/views/Product.vue"],"sourcesContent":["<template>\n    <div class=\"page-product\">\n\n        <div class=\"catalog-card2\">\n            <div class=\"catalog-card2__imgbox\">\n                <figure class=\"image mb-6\">\n                    <img v-bind:src=\"product.get_image\">\n                </figure>\n            </div>\n            <div class=\"catalog-card2__description\">\n                <h4 class=\"catalog-card2__title\">\n                    {{ product.name }}\n                </h4>\n                <div class=\"catalog-card2__star \" data-rateyo-rating=\"4\"></div>\n                <p class=\"catalog-card2__price\">\n                    ${{ product.price }}\n                </p>\n                <p class=\"catalog-card2__text\">\n                    {{ product.description }}\n                </p>\n                <div class=\"field has-addons mt-6\">\n                    <div class=\"control\">\n                        <input type=\"number\" class=\"input\" min=\"1\" v-model=\"quantity\">\n                    </div>\n\n                    <div class=\"control\">\n                        <a class=\"button is-dark\" @click=\"addToCart\">Add to cart</a>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class=\"columns is multiline\">\n\n            <div class=\"column is-9\">\n                <h2 class=\"title\">Reviews:</h2>\n                <div v-for=\"review in reviews\" :key=\"review.id\" class=\"review-wrapper\">\n                    <p class=\"title\">Review</p>\n                    <p>User_name: {{ review.user }}</p>\n                    <p>Stars: {{ review.stars }}</p>\n                    <p class=\"review-wrapper__text\">Review text:{{ review.content }}</p>\n                    <p>Date: {{ review.date_added }}</p>\n                </div>\n\n                <div>\n                    <form @submit.prevent=\"submitReview\">\n                        <label for=\"content\">Отзыв:</label>\n                        <textarea v-model=\"review.content\" id=\"content\" required></textarea>\n\n                        <label for=\"stars\">Оценка:</label>\n                        <input v-model.number=\"review.stars\" type=\"number\" id=\"stars\" required max=\"5\" />\n\n                        <button type=\"submit\">Отправить отзыв</button>\n                    </form>\n                </div>\n            </div>\n        </div>\n\n    </div>\n</template>\n\n<style lang=\"scss\">\n\n.catalog-card2 {\n    display: flex;\n    justify-content: space-evenly;\n\n    &__description{\n        max-width: 700px;\n    }\n}\n\n.review-wrapper {\n    margin-bottom: 20px;\n    border-bottom: 1px solid #a3bbc8;\n\n    &__text {\n        font-size: 16px;\n        line-height: 30px;\n        color: #2292a5;\n    }\n\n}\n\n</style>\n\n<script>\nimport axios from 'axios'\nimport { toast } from 'bulma-toast'\n\nexport default {\n    name: 'Product',\n    data() {\n        return {\n            product: {},\n            review: {},\n            reviews: {},\n            'quantity': 1,\n            user_id: null,\n            user_info: {},\n            userreviewid: [],\n            review_userid_List: [],\n        }\n    },\n    mounted() {\n        this.getProduct(),\n            this.getProductReviews(),\n            this.getUserInfo()\n    },\n    methods: {\n        async getProduct() {\n            this.$store.commit('setIsLoading', true)\n\n            const category_slug = this.$route.params.category_slug\n            const product_slug = this.$route.params.product_slug\n\n            await axios\n                .get(`/api/v1/products/${category_slug}/${product_slug}`)\n                .then(response => {\n                    this.product = response.data\n\n                    document.title = this.product.name + ' | Glee'\n                })\n                .catch(error => {\n                    console.log(error)\n                })\n            this.$store.commit('setIsLoading', false)\n        },\n\n        async getUserInfo() {\n\n            await axios\n                .get('api/v1/users/me/', {\n                    headers: {\n                        Authorization: `Token ${localStorage.getItem('token')}`\n                    }\n                })\n                .then(response => {\n                    this.user_info = response.data\n                    this.user_id = response.data.id\n                })\n                .catch(error => {\n                    console.log(error)\n                })\n        },\n\n\n        async getProductReviews() {\n            const category_slug = this.$route.params.category_slug\n            const product_slug = this.$route.params.product_slug\n\n            await axios\n                .get(`/api/v1/products/${category_slug}/${product_slug}/reviews`)\n                .then(response => {\n                    this.reviews = response.data\n                    this.review_userid_List = this.reviews.map(review => review.user)\n                })\n                .catch(error => {\n                    console.log(error)\n                })\n        },\n\n\n        async submitReview() {\n            if (this.review_userid_List.includes(this.user_id)) // Checking whether the user has left a review for this product\n                toast({\n                    message: 'You already have a review for this product!',\n                    type: 'is-warning',\n                    position: 'center',\n                    duration: 3000,\n                });\n            else\n                try {\n                    const category_slug = this.$route.params.category_slug\n                    const product_slug = this.$route.params.product_slug\n\n                    const reviewData = {\n                        user: this.user_id,\n                        content: this.review.content,\n                        stars: this.review.stars,\n                    }\n\n\n                    const response = await axios.post(`/api/v1/products/${category_slug}/${product_slug}/reviews/`, reviewData)\n                    console.log('Server response:', response.data)\n\n\n                    this.review = {}\n                    this.getProductReviews()\n\n\n                    toast({\n                        message: 'Review sent successfully',\n                        type: 'is-success',\n                        position: 'bottom-right',\n                        duration: 3000,\n                    });\n                } catch (error) {\n                    console.error('Error sending review:', error.response.data);\n\n                    toast({\n                        message: 'Error sending review',\n                        type: 'is-danger',\n                        position: 'bottom-right',\n                        duration: 3000,\n                    });\n                }\n        },\n\n        addToCart() {\n            if (isNaN(this.quantity) || this.quantity < 1) {\n                this.quantity = 1\n            }\n\n            const item = {\n                product: this.product,\n                quantity: this.quantity\n            }\n\n            this.$store.commit('addToCart', item)\n\n            toast({\n                message: 'The product was added to the cart',\n                type: 'is-success',\n                dismissible: true,\n                pauseOnHover: true,\n                duration: 2000,\n                position: 'bottom-right',\n            })\n\n\n        }\n    }\n}\n</script>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}